name: Secrets Audit (Monitor)

on:
  workflow_dispatch:
  schedule:
    - cron: '20 3 * * *'   # Run daily at 03:20 UTC (10:20 ICT)

permissions:
  contents: read

jobs:
  monitor:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    steps:
      - uses: actions/checkout@v4

      - name: Audit workflow execution
        run: |
          set -euo pipefail
          echo "::notice::Monitor running: $GITHUB_WORKFLOW @ $GITHUB_SHA on $GITHUB_REF"
          echo "Repository: $GITHUB_REPOSITORY"
          echo "Environment: web-test"

      - name: Verify required secrets are configured
        env:
          REQUIRED_SECRETS: "GCP_WIF_PROVIDER GCP_SERVICE_ACCOUNT"
        run: |
          set -euo pipefail
          echo "::notice::Secrets audit for web-test repository"
          echo "This is a monitoring workflow to ensure critical secrets exist"
          echo "Required secrets: $REQUIRED_SECRETS"
          echo "Note: Secret values are never exposed, only existence is monitored"
